/**
 * cookie
 *
 * @param {object} req
 * @return {object} {cookie:value}
 */
exports.cookie = function(req){
    if(!req.headers.cookie){
        return {};
    }
    var temp = req.headers.cookie.split(";");
    var cookie = {};
    for(var i=0;i<temp.length;i++){
        var temp_2 = temp[i].split("=");
        temp_2[0] = temp_2[0].replace(/^\s*/,'');
        cookie[temp_2[0]] = temp_2[1];
    }
    return cookie;
};

/**
 * 设置cookie
 *
 * @param {object} cookie
 * @param {number} time
 * @param {string} path
 * @param {object} req
 * @param {object} res
 */
exports.setCookie = function(cookie,time,path,req,res,httponly){
    var result = [];
    var only = httponly?'httponly;':'';
    for(var p in cookie){
        if(time||time==0){
            result.push(p+"="+cookie[p]+";expires="+new Date(new Date()-0+time)+";path="+(path||'/')+";"+only);
        }else{
            result.push(p+"="+cookie[p]+";path="+(path||'/')+";"+only);
        }
    }

    harbors.log('setCookie:'+result);
    res.setHeader("Set-Cookie", result);
};