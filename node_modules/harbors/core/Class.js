var harbors = require('../index');

var ClassManager = {

    id : (0|(Math.random()*998)),

    instanceId : (0|(Math.random()*998)),

    getNewID : function(){
        return this.id++;
    },

    getNewInstanceId : function(){
        return this.instanceId++;
    }
};

harbors.Class = function(){};

harbors.Class.extend = function(prop){

    var _super = this.prototype;
    var prototype = Object.create(_super);

    for(var p in prop){
        prototype[p] = prop[p];
    }

    var classId = ClassManager.getNewID();
    ClassManager[classId] = _super;

    function Class() {
        this.__instanceId = ClassManager.getNewInstanceId();
        // All construction is actually done in the init method
        if (this.ctor)
            this.ctor.apply(this, arguments);
    }

    Class.id = classId;

    Class.prototype = prototype;

    Class.extend = harbors.Class.extend;

    return Class;
};