var harbors = require('../index');

var url = require('url');

harbors.Request = {

    getHeaders: function(name){
        return name ? this.headers[name] : this.headers;
    },

    getURL: function(){
        if(this._parseUrl === null)
            this._parseUrl = url.parse(this.url, true);

        return this._parseUrl.pathname;
    },

    getGetParam: function(){
        if(this._parseUrl === null)
            this._parseUrl = url.parse(this.url, true);
        return this._parseUrl.query;
    },

    getPostParam: function(){
        var check = false;
        var postData = '';
        this.setEncoding('utf8');
        this.addListener('data', function(postDataChunk) {
            postData += postDataChunk;
        });
        this.addListener('end', function() {
            check = true;
            console.log(postData)
        });
        function zd(){
            if(check === false)
                processImmediate(zd);
        }
        return postData;
    }
};

harbors.Request.create = function(req){
    for(var p in harbors.Request){
        req[p] = harbors.Request[p];
    }
    return req;
};