global.harbors = {};
/**
 * 导入工具集
 */
harbors.Utils = require('../lib/Utils');

/**
 * 导入配置文件,合并用户配置,如配置冲突,使用用户配置
 */
harbors.config = require('./config');
try{
    harbors.config = harbors.Utils.merge(harbors.config,require('../../../config/config'));
}catch(err){
    console.log('User configuration file not found!');
}

/**
 * 注册程序启动参数
 */
var program = require('./Argv');

/**
 * 初始化服务器
 */
harbors.session = {};
harbors.vhost = require('./vhost');
try{
    harbors.vhost = require('../../../config/vhost');
}catch(err){
    harbors._dev&&console.log(err);
    harbors._dev&&console.log('User vhost file not found!');
}

/**
 * 检查配置正确性（功能后期完善）
 */
require('../lib/CheckConfig')(harbors.config);

/**
 * 启动服务进程集群
 */
require('./cluster');
