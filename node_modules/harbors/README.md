harbors ![build status](https://secure.travis-ci.org/coreyti/showdown.png)
=======

一款轻量级的web服务器框架 v0.2.0


  欢迎提交各种bug、建议到邮箱：devhacker520@gmail.com

  大家的意见以及大家的鼓励，将成为开发的动力。


安装方法：

    npm install harbors

开启session功能需要redis支持

node start.js会自动调用harbors，服务器会自动处理路由关系，后续版本将增加手动路由表功能。



##运行模式

harbors支持两种模式的服务器状态：

1、'dynamic'：动态解析模式。

2、'static'：静态文件服务器模式。


'dynamic'模式下harbors处理完数据会在controller目录下寻找filter.js过滤器。并传递给req，res两个参数。语法和原生nodejs一致。（api见下）

'static'是处理静态文件请求服务的模式。收到浏览器请求后，会在view文件夹下自动寻找请求的文件，存在则返回给浏览器。

##vhost虚拟主机

harbors支持apache的vhost类似功能。具体配置在config/config.js中开启。vhost设置在config/vhost.js文件中。

支持单独配置每个虚拟主机的运行模式、以及服务器缓存等等。

需要注意的是，如果在config.js中开启了vhost，则不管是'dynamic'还是'static'模式都会在目录下寻找自己的主机目录。

如原目录：controller/default/filter.js

开启vhost后：controller/vhost.baseDir/filter.js



##API

###request

  >**request.cookie**
  >
  >cookie对象封装，格式{cookieName:cookieValue}
  >
  >**request.session**
  >
  >session对象封装（需要在config.js开启session功能，会轻微影响服务器性能）格式同cookie。
  >
  >开启session的同时会生成一个cookie，名字可以在config.js设置。session下的update一般情况请勿操作。服务器会自行判断更新该值。
  >
  >**request.path**
  >
  >路由路径封装。浏览器地址http://xxx.com/admin/index/index.html 返回 ['admin','index','index.html']


###response

  >**response.setCookie(obj,expires,path)**
  >
  >obj=>传入的cookie，expires=>过期时间,等于0时删除填入的cookie，path=>cookie存储path
  >
  >设置cookie函数，传入参数{cookieName:cookieValue}
  >
  >删除cookie函数，传入参数{cookieName:cookieValue}（必须要完全对应）
  >
  >**response.setSession(obj,expires)**
  >
  >obj=>传入的session，expires=>过期时间,等于0时删除填入的session
  >
  >设置、删除session函数，传入参数{sessionName:sessionValue}
  >
  >**response.display(file)**
  >
  >返回静态文件。传入file地址。未开启vhost的情况在view/default目录下寻找，如显示view/default/index.html => response.display('index.html');
  >
  >如果开启了vhost，则会在view目录后面自动跟上vhost目录。如：view/admin/index.html
  >
  >**response.render(file,param)**
  >
  >传入file地址。和file方法一样，不过render渲染的是jade模板，传入jade模板文件，第二个参数为传入参数。

##Database

###mysql

在config开启mysql后，可以在任何地方使用harbors.mysql调用。

  >**harbors.mysql(sql,callback)**

###redis

在config开启redis后，可以在任何地方使用harbors.redis调用。

  >**harbors.redis.xxx**
  >
  >文档完善中

