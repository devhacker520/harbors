var app = {
    init:function(){
        //连接数据库
        var mq = require("mysql");
        app.mysql = mq.createConnection({
            host : harbors.config.databaseHost,
            user: harbors.config.databaseUser,
            password: harbors.config.databasePassword
        });
        app.mysql.connect();
        //连接默认数据库
        app.changeDatabase(harbors.config.databaseName);
    },
    changeDatabase:function(database){
        app.mysql.query("use "+database);
    },
    findOne:function(){
        var result = '';
        for(var i in condition){
            result=='' ? (result+=' '+i+'="'+condition[i]+'"') : (result+=' and '+i+'="'+condition[i]+'"');
        }
        app.mysql.query("select * from "+table+" where"+result, function(err, rs, fields){
            typeof(callback)=='function' && callback(rs);
        });
    },
    findAll:function(table,callback){
        app.mysql.query("select * from "+table, function(err, rs, fields){
            typeof(callback)=='function' && callback(rs);
        });
    },
    insertOne:function(table,condition,callback){
        var result = '';
        var result2 = '';
        for(var i in condition){
            result=='' ? (result+=i) : (result+=','+i);
            result2=='' ? (result2+="'"+condition[i]+"'") : (result2+=",'"+condition[i]+"'");
        }
        app.mysql.query("insert into "+table+" ("+result+") values ("+result2+")", function(err, rs, fields){
            typeof(callback)=='function' && callback(rs);
        });
    },
    query:function(query){
        app.mysql.query(query);
    }
};

module.exports = app;