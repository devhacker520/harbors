/**
 * 合并虚拟主机配置
 */
exports.mergeVirtualHost = function(){
    var config = harbors.utils.merge({},harbors.config);
    delete config.mysql;
    delete config.redis;
    delete config.listenPort;
    delete config.baseDir;
    delete config.clusterNum;
    delete config.vhost;
    if(harbors.config.vhost){
        for(var p in harbors.vhost){
            harbors.vhost[p] = harbors.utils.merge(config,harbors.vhost[p]);
        }
    }else{
        harbors.vhost = {'*':config};//虚拟主机功能未开启、读取默认配置给'*'主机
    }
    console.log(harbors.vhost)
};

/**
 * 创建虚拟路由
 */
var virtualRouter = require('../library/virtualRouter');
exports.createVirtualRoute = function(){
    for(var p in harbors.vhost){
        harbors.vhost[p]['route'] = virtualRouter.extraction(harbors.vhost[p]);
    }
};